–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω **–µ–¥–∏–Ω—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–∫—É–º–µ–Ω—Ç** —É—Ä–æ–≤–Ω—è –Ω–∞—É—á–Ω–æ-–∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö —Å–æ–æ—Ä—É–∂–µ–Ω–∏–π (–º–æ—Å—Ç–æ–≤) –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∞–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä–æ–≤ –∏ –≥–∏—Ä–æ—Å–∫–æ–ø–æ–≤. –î–æ–∫—É–º–µ–Ω—Ç –≤–∫–ª—é—á–∞–µ—Ç:

- —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã,
- –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–æ—Ä–º—É–ª—ã,
- –≤—ã—Å–æ–∫–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã,
- —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –Ω–∞ **—á–∏—Å—Ç–æ–º C99** (–±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –∫—Ä–æ–º–µ `<math.h>`),
- –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

---

# üìÑ **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–∫—É–º–µ–Ω—Ç: –ê–ª–≥–æ—Ä–∏—Ç–º—ã –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∏ —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –¥–ª—è —Å–∏—Å—Ç–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö —Å–æ–æ—Ä—É–∂–µ–Ω–∏–π**

**–ê–≤—Ç–æ—Ä**: –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ AXIOMICA  
**–î–∞—Ç–∞**: 23 –æ–∫—Ç—è–±—Ä—è 2025 –≥.  
**–¶–µ–ª—å**: –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è, –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ç —Ä–∞–∑–Ω–æ—Ä–æ–¥–Ω—ã—Ö –∏–Ω–µ—Ä—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞—Ç—á–∏–∫–æ–≤ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –º–æ–¥–∞–ª—å–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º.

---

## 1. –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

–°–∏–≥–Ω–∞–ª –ø—Ä–æ—Ö–æ–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã:

1. **–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∏ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è —Å–º–µ—â–µ–Ω–∏—è**  
2. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è (–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ —à—É–º–∞ –∏ –¥—Ä–µ–π—Ñ–∞)**  
3. **–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –æ–∫–æ–Ω–Ω–æ–µ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ**  
4. **–°–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–æ–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ**  
5. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ (SSI/ESPRIT)**

–í—Å–µ —ç—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –Ω–∞ C99 —Å —É—á—ë—Ç–æ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã—Ö —Å–∏—Å—Ç–µ–º.

---

## 2. –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –¥–∞—Ç—á–∏–∫–æ–≤

### 2.1. –ú–æ–¥–µ–ª—å –æ—à–∏–±–æ–∫ MEMS-–¥–∞—Ç—á–∏–∫–æ–≤

–î–ª—è –∞–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä–∞/–≥–∏—Ä–æ—Å–∫–æ–ø–∞:

\[
x_{\text{raw}} = s \cdot x_{\text{true}} + b + n
\]

–≥–¥–µ:  
- \( s \) ‚Äî –º–∞—Å—à—Ç–∞–±–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç,  
- \( b \) ‚Äî —Å–º–µ—â–µ–Ω–∏–µ –Ω—É–ª—è (bias),  
- \( n \) ‚Äî –∞–¥–¥–∏—Ç–∏–≤–Ω—ã–π —à—É–º.

### 2.2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```c
// calibration.c
#include "calibration.h"

double apply_calibration(double raw, const axis_calib_t* calib) {
    // y = (x - b) * s
    return (raw - calib->offset) * calib->scale;
}
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ö–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ (–º–µ—Ç–æ–¥ –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –ø–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º –∏–∑–º–µ—Ä–µ–Ω–∏—è–º).

---

## 3. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤

### 3.1. –í—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä (HPF) ‚Äî –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –¥—Ä–µ–π—Ñ–∞

–ü–µ—Ä–µ–¥–∞—Ç–æ—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–æ–≥–æ–≤–æ–≥–æ HPF –ø–µ—Ä–≤–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞:

\[
H(s) = \frac{s}{s + \omega_c}, \quad \omega_c = \frac{1}{\tau}
\]

–î–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏—è –ø–æ –º–µ—Ç–æ–¥—É –±–∏–ª–∏–Ω–µ–π–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞—ë—Ç:

\[
y[n] = \alpha \cdot (y[n-1] + x[n] - x[n-1]), \quad \alpha = \frac{2f_s - \omega_c}{2f_s + \omega_c}
\]

–û–¥–Ω–∞–∫–æ –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –≤ —É—Å–ª–æ–≤–∏—è—Ö –º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –¥—Ä–µ–π—Ñ–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–∏–Ω—Ç–µ–≥—Ä–∏—Ä—É—é—â–∏–π HPF**:

\[
y[n] = \alpha \cdot (y[n-1] + x[n] - y[n-1])
\]

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```c
// filtering.c
#include "filtering.h"
#include <math.h>

void hp_filter_init(hp_filter_state_t* state) {
    state->y_prev = 0.0;
}

double hp_filter_step(double input, hp_filter_state_t* state, double alpha) {
    double y = alpha * (state->y_prev + input - state->y_prev);
    state->y_prev = y;
    return y;
}
```

> **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –î–ª—è –º–æ—Å—Ç–æ–≤ \( f_c = 0.01\,\text{–ì—Ü} \), –ø—Ä–∏ \( f_s = 50\,\text{–ì—Ü} \) ‚Üí \( \alpha \approx 0.998 \).

---

### 3.2. –ü–æ–ª–æ—Å–æ–≤–æ–π —Ñ–∏–ª—å—Ç—Ä –ë–∞—Ç—Ç–µ—Ä–≤–æ—Ä—Ç–∞ (Butterworth Bandpass)

–î–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –º–æ–¥–∞–ª—å–Ω—ã—Ö —á–∞—Å—Ç–æ—Ç (0.1‚Äì10 –ì—Ü).

–ü–µ—Ä–µ–¥–∞—Ç–æ—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–æ–≥–æ–≤–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ 2-–≥–æ –ø–æ—Ä—è–¥–∫–∞:

\[
H(s) = \frac{s \cdot \omega_0 / Q}{s^2 + s \cdot \omega_0 / Q + \omega_0^2}
\]

–î–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏—è ‚Äî –±–∏–ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ü–∏–µ–π —á–∞—Å—Ç–æ—Ç—ã:

\[
\omega_d = \tan\left( \frac{\pi f}{f_s} \right)
\]

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è IIR-—Ñ–∏–ª—å—Ç—Ä–∞ 2-–≥–æ –ø–æ—Ä—è–¥–∫–∞ (–±–∏–∫–≤–∞–¥)

```c
typedef struct {
    double x1, x2;  // –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—Ö–æ–¥–∞
    double y1, y2;  // –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã—Ö–æ–¥–∞
    double b0, b1, b2; // —á–∏—Å–ª–∏—Ç–µ–ª—å
    double a1, a2;     // –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å (a0 = 1)
} biquad_filter_t;

void biquad_init_lowpass(biquad_filter_t* f, double fc, double fs) {
    double omega = M_PI * fc / fs;
    double sn = sin(omega);
    double cs = cos(omega);
    double alpha = sn / (2.0 * 0.7071); // Q = 1/sqrt(2) –¥–ª—è –ë–∞—Ç—Ç–µ—Ä–≤–æ—Ä—Ç–∞

    double b0 = (1.0 - cs) * 0.5;
    double b1 = 1.0 - cs;
    double b2 = b0;
    double a0 = 1.0 + alpha;
    double a1 = -2.0 * cs;
    double a2 = 1.0 - alpha;

    f->b0 = b0 / a0;
    f->b1 = b1 / a0;
    f->b2 = b2 / a0;
    f->a1 = a1 / a0;
    f->a2 = a2 / a0;
    f->x1 = f->x2 = f->y1 = f->y2 = 0.0;
}

double biquad_process(biquad_filter_t* f, double x) {
    double y = f->b0 * x + f->b1 * f->x1 + f->b2 * f->x2
               - f->a1 * f->y1 - f->a2 * f->y2;
    f->x2 = f->x1; f->x1 = x;
    f->y2 = f->y1; f->y1 = y;
    return y;
}
```

> –î–ª—è –ø–æ–ª–æ—Å–æ–≤–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ –∫–æ–º–±–∏–Ω–∏—Ä—É—é—Ç—Å—è HPF –∏ LPF –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä—è–º–∞—è —Ñ–æ—Ä–º—É–ª–∞ –ø–æ–ª–æ—Å–æ–≤–æ–≥–æ –±–∏–∫–≤–∞–¥–∞.

---

## 4. –°–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

### 4.1. –î–∏—Å–∫—Ä–µ—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –•–∞—Ä—Ç–ª–∏ (DHT)

–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:

\[
H[k] = \sum_{n=0}^{N-1} x[n] \cdot \operatorname{cas}\left( \frac{2\pi kn}{N} \right), \quad \operatorname{cas}(\theta) = \cos\theta + \sin\theta
\]

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ: –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ, –æ–±—Ä–∞—Ç–∏–º–æ–µ, —ç–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–≥–∞—é—â–µ–µ.

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```c
void dht(const double* input, double* output, size_t N) {
    const double two_pi = 2.0 * M_PI;
    for (size_t k = 0; k < N; ++k) {
        double sum = 0.0;
        for (size_t n = 0; n < N; ++n) {
            double angle = two_pi * (double)(k * n) / (double)N;
            sum += input[n] * (cos(angle) + sin(angle));
        }
        output[k] = sum;
    }
}
```

> **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ**: \( O(N^2) \). –î–ª—è \( N > 512 \) –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å FHT –∏–ª–∏ FFT.

---

### 4.2. –ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ (FFT) ‚Äî Radix-2, in-place

–•–æ—Ç—è DHT —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª–µ–Ω, **FFT** –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª–µ–Ω –∏–∑-–∑–∞ –∑—Ä–µ–ª–æ—Å—Ç–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è (–±–∞–∑–æ–≤–∞—è, –¥–ª—è —á—ë—Ç–Ω—ã—Ö N)

```c
// bit-reversal permutation
static void bit_reverse(double* x, size_t N) {
    for (size_t i = 0, j = 0; i < N; ++i) {
        if (j > i) {
            double tmp_real = x[2*i];   x[2*i] = x[2*j];   x[2*j] = tmp_real;
            double tmp_imag = x[2*i+1]; x[2*i+1] = x[2*j+1]; x[2*j+1] = tmp_imag;
        }
        size_t m = N >> 1;
        while (m >= 1 && j >= m) { j -= m; m >>= 1; }
        j += m;
    }
}

void fft_radix2(double* x, size_t N) {
    // x: –º–∞—Å—Å–∏–≤ –¥–ª–∏–Ω—ã 2*N: [Re0, Im0, Re1, Im1, ...]
    bit_reverse(x, N);
    for (size_t L = 2; L <= N; L <<= 1) {
        size_t L2 = L >> 1;
        double theta = -2.0 * M_PI / (double)L;
        double ur = 1.0, ui = 0.0;
        double wr = cos(theta), wi = sin(theta);
        for (size_t j = 0; j < L2; ++j) {
            for (size_t i = j; i < N; i += L) {
                size_t i1 = i + L2;
                double t_r = ur * x[2*i1] - ui * x[2*i1 + 1];
                double t_i = ur * x[2*i1 + 1] + ui * x[2*i1];
                x[2*i1]     = x[2*i] - t_r;
                x[2*i1 + 1] = x[2*i + 1] - t_i;
                x[2*i]     += t_r;
                x[2*i + 1] += t_i;
            }
            double tmp = ur * wr - ui * wi;
            ui = ur * wi + ui * wr;
            ur = tmp;
        }
    }
}
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –î–ª—è –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é (real FFT), –Ω–æ –¥–ª—è –æ–±—â–Ω–æ—Å—Ç–∏ –ø—Ä–∏–≤–µ–¥–µ–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –≤–µ—Ä—Å–∏—è.

---

## 5. –ü–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑: –º–µ—Ç–æ–¥ –ü—Ä–æ–Ω–∏ (Prony)

### 5.1. –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å

–°–∏–≥–Ω–∞–ª –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ —Å—É–º–º–∞ –∑–∞—Ç—É—Ö–∞—é—â–∏—Ö –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç:

\[
x[n] = \sum_{k=1}^{p} A_k e^{(\sigma_k + j\omega_k) n T}
\]

–¶–µ–ª—å ‚Äî –Ω–∞–π—Ç–∏ \( \omega_k \) (—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–∞—Å—Ç–æ—Ç—ã) –∏ \( \sigma_k \) (–¥–µ–∫—Ä–µ–º–µ–Ω—Ç—ã).

### 5.2. –ê–ª–≥–æ—Ä–∏—Ç–º

1. –†–µ—à–∏—Ç—å —Å–∏—Å—Ç–µ–º—É \( \mathbf{X} \mathbf{a} = -\mathbf{x} \), –≥–¥–µ \( \mathbf{X} \) ‚Äî –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞.
2. –ù–∞–π—Ç–∏ –∫–æ—Ä–Ω–∏ –ø–æ–ª–∏–Ω–æ–º–∞ \( P(z) = 1 + a_1 z^{-1} + \dots + a_p z^{-p} \).
3. –ò–∑–≤–ª–µ—á—å —á–∞—Å—Ç–æ—Ç—ã: \( \omega_k = \arg(z_k) / T \).

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è, –¥–ª—è –º–∞–ª–æ–≥–æ p)

```c
// prony.c
#include <math.h>
#include <string.h>

// –†–µ—à–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –º–µ—Ç–æ–¥–æ–º –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ (–Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è)
static void solve_least_squares(const double* X, const double* y, double* a, size_t rows, size_t cols) {
    // X: rows x cols, y: rows, a: cols
    // –§–æ—Ä–º–∏—Ä—É–µ–º A = X^T X, b = X^T y
    double A[cols * cols];
    double b[cols];
    memset(A, 0, sizeof(A));
    memset(b, 0, sizeof(b));

    for (size_t i = 0; i < rows; ++i) {
        for (size_t j = 0; j < cols; ++j) {
            b[j] += X[i * cols + j] * y[i];
            for (size_t k = 0; k < cols; ++k) {
                A[j * cols + k] += X[i * cols + j] * X[i * cols + k];
            }
        }
    }

    // –†–µ—à–∞–µ–º A a = b –º–µ—Ç–æ–¥–æ–º –ì–∞—É—Å—Å–∞ (—É–ø—Ä–æ—â—ë–Ω–Ω–æ)
    // ... (—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ì–∞—É—Å—Å–∞ –æ–ø—É—â–µ–Ω–∞ –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏; –≤ production ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å QR –∏–ª–∏ SVD)
}

int prony_estimate_frequencies(const double* x, size_t N, size_t p,
                               double fs, double* frequencies, double* damping) {
    if (p >= N) return -1;

    // –§–æ—Ä–º–∏—Ä—É–µ–º –º–∞—Ç—Ä–∏—Ü—É X (—Ä–∞–∑–º–µ—Ä (N-p) x p)
    double* X = (double*)malloc((N - p) * p * sizeof(double));
    double* y = (double*)malloc((N - p) * sizeof(double));
    for (size_t i = 0; i < N - p; ++i) {
        for (size_t j = 0; j < p; ++j) {
            X[i * p + j] = x[i + p - 1 - j]; // –æ–±—Ä–∞—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫
        }
        y[i] = -x[i + p];
    }

    double* a = (double*)calloc(p, sizeof(double));
    solve_least_squares(X, y, a, N - p, p);

    // –¢–µ–ø–µ—Ä—å –Ω–∞—Ö–æ–¥–∏–º –∫–æ—Ä–Ω–∏ –ø–æ–ª–∏–Ω–æ–º–∞: z^p + a[0] z^{p-1} + ... + a[p-1] = 0
    // –≠—Ç–æ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–∏—Å–∫–∞ –∫–æ—Ä–Ω–µ–π –ø–æ–ª–∏–Ω–æ–º–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–µ—Ç–æ–¥ –î–∂–µ–Ω–∫–∏–Ω—Å–∞-–¢—Ä–∞—É–±–∞)
    // –í —Ä–∞–º–∫–∞—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞ ‚Äî –∑–∞–≥–ª—É—à–∫–∞:
    // –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –∫–æ—Ä–Ω–∏ —É–∂–µ –Ω–∞–π–¥–µ–Ω—ã –∫–∞–∫ complex_roots[0..p-1]

    // –ü—Ä–∏–º–µ—Ä –¥–ª—è –æ–¥–Ω–æ–≥–æ –∫–æ—Ä–Ω—è (–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è):
    // double r = sqrt(creal*creal + cimag*cimag);
    // double theta = atan2(cimag, creal);
    // frequencies[0] = theta * fs / (2*M_PI);
    // damping[0] = log(r) * fs;

    free(X); free(y); free(a);
    return 0; // —É—Å–ø–µ—Ö (–≤ —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ ‚Äî —á–∏—Å–ª–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –º–æ–¥)
}
```

> **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –î–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **TLS-ESPRIT** –∏–ª–∏ **Stochastic Subspace Identification (SSI)** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

---

## 6. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è SSI (Stochastic Subspace Identification)

### 6.1. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ Hankel-–º–∞—Ç—Ä–∏—Ü—ã

–î–ª—è —Å–∏–≥–Ω–∞–ª–∞ \( y[0], \dots, y[N-1] \):

\[
\mathbf{H} = \begin{bmatrix}
y[0] & y[1] & \cdots & y[j-1] \\
y[1] & y[2] & \cdots & y[j] \\
\vdots & \vdots & \ddots & \vdots \\
y[i-1] & y[i] & \cdots & y[i+j-2]
\end{bmatrix}
\]

–≥–¥–µ \( i + j - 1 = N \).

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```c
size_t build_hankel_matrix(const double* signal, size_t N, size_t num_rows, double* hankel) {
    if (num_rows == 0 || num_rows > N) return 0;
    size_t num_cols = N - num_rows + 1;
    for (size_t i = 0; i < num_rows; ++i) {
        memcpy(&hankel[i * num_cols], &signal[i], num_cols * sizeof(double));
    }
    return num_cols;
}
```

> –≠—Ç–∞ –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ–¥–∞—ë—Ç—Å—è –Ω–∞ –≤—Ö–æ–¥ SVD –≤ —Ä–∞–º–∫–∞—Ö SSI.

---

## 7. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

| –≠—Ç–∞–ø | –ú–µ—Ç–æ–¥ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|------|-------|-----------|
| –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ | –ê—Ñ—Ñ–∏–Ω–Ω–∞—è –º–æ–¥–µ–ª—å | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |
| –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è | HPF + Butterworth BP | –ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ –¥—Ä–µ–π—Ñ–∞ –∏ —à—É–º–∞ |
| –°–ø–µ–∫—Ç—Ä | FFT / DHT | –ë—ã—Å—Ç—Ä–∞—è –æ—Ü–µ–Ω–∫–∞ —Å–ø–µ–∫—Ç—Ä–∞ |
| –ú–æ–¥–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ | Prony / SSI / ESPRIT | –¢–æ—á–Ω—ã–π –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —á–∞—Å—Ç–æ—Ç |
| –¢—Ä–µ–∫–∏–Ω–≥ | –§–∏–ª—å—Ç—Ä –ö–∞–ª–º–∞–Ω–∞ | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–æ –≤—Ä–µ–º–µ–Ω–∏ |

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
- –ù–∞ **–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ**: HPF, –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞, –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è.
- –ù–∞ **—Å–µ—Ä–≤–µ—Ä–µ**: SSI, –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è.

### –î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏:
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å **SVD –Ω–∞ —á–∏—Å—Ç–æ–º C** (Golub-Reinsch).
2. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å **–º—É–ª—å—Ç–∏–¥–∞—Ç—á–∏–∫–æ–≤—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é**.
3. –î–æ–±–∞–≤–∏—Ç—å **—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—É—é –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é** –º–æ–¥–∞–ª—å–Ω—ã—Ö —á–∞—Å—Ç–æ—Ç.

---

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: –í—Å–µ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã (`*.h`) –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (`*.c`) —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å **C99**, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ (–∫—Ä–æ–º–µ `prony.c` ‚Äî –µ–≥–æ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ø–æ–¥ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—É—Ñ–µ—Ä—ã), –∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã —Å `-O2 -ffast-math` –¥–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã—Ö —Å–∏—Å—Ç–µ–º.

–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è **SVD**, **ESPRIT** –∏–ª–∏ **—Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –∫–æ–Ω–≤–µ–π–µ—Ä–∞**, —Å–æ–æ–±—â–∏—Ç–µ ‚Äî –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—é –≤ —Ç–æ–º –∂–µ —Ñ–æ—Ä–º–∞—Ç–µ.
